---
tags:
  - kubernetes
  - linux
  - virtualization
  - containers
  - theory
created: 2026-02-12
---

# VM, Container, Pod — обзор и сравнение

Три уровня изоляции: от аппаратной виртуализации до группировки процессов.

## Спектр изоляции

```
  Isolation ──────────────────────────────────────────────►
  Overhead  ──────────────────────────────────────────────►

  Process ──► Container ──► microVM ──► VM ──► Bare Metal
```

| | Process | Container | microVM (Firecracker) | VM | Bare Metal |
|---|---|---|---|---|---|
| **Kernel** | Host | Host | Own (minimal) | Own (full OS) | Full control |
| **FS** | Shared | Own rootfs | Own rootfs | Virtual disk | Physical |
| **Network** | Shared | Own NS | Own NS | Virtual NIC | Physical |
| **Overhead** | ~0 | ~0 | ~5 MiB | ~GiB | N/A |
| **Boot** | ~0 ms | ~50 ms | ~125 ms | ~1-2 s | N/A |

Каждый уровень добавляет **границу доверия** (trust boundary). Процесс доверяет ядру. Контейнер доверяет ядру, но ограничен в видимости. VM имеет собственное ядро, граница доверия проходит на уровне гипервизора.

---

## Виртуальная машина (VM)

**Процесс гипервизора** (QEMU/KVM), внутри которого работает полноценная гостевая ОС со своим ядром. Гостевые процессы **не видны** на хосте — в `ps aux` виден только один процесс `qemu-system-x86_64`.

> Подробно: [[VirtualMachine]]

## Контейнер

**Обычный процесс Linux**, ограниченный тремя механизмами ядра: namespaces (изоляция видимости), cgroups (лимиты ресурсов), overlay FS (слоёная файловая система). В ядре Linux **нет сущности "контейнер"** — это конвенция userspace. Все процессы контейнеров **видны** в `ps aux` на хосте.

> Подробно: [[Container]]

## Pod

**Группа контейнеров** с общими namespaces (сеть, IPC, hostname). Минимальная единица развёртывания в Kubernetes. Первым в Pod'е запускается **pause container** — программа из ~30 строк C, которая создаёт и удерживает общие namespaces. Аналогия из Unix: **process group**.

> Подробно: [[Pod]]

---

## Сравнительная таблица

| | **VM** | **Container** | **Pod** |
|---|---|---|---|
| **Что это** | Процесс гипервизора (QEMU/KVM) | Процесс Linux + namespaces + cgroups | Группа контейнеров + общие NS |
| **Ядро ОС** | Своё (гостевое) | Общее с хостом | Общее с хостом |
| **Изоляция** | Аппаратная (VT-x/AMD-V) | Программная (namespaces) | Программная (namespaces) |
| **Видимость в `ps aux`** | Только `qemu-*` | **ВСЕ процессы видны** | Все процессы + pause |
| **Overhead RAM** | 200MB+ | ~0 | ~1MB (pause) |
| **Время старта** | 10-60 сек | < 1 сек | 1-5 сек |
| **Сетевая модель** | Виртуальный NIC | veth pair + CNI | Общий NET NS |
| **Файловая система** | Виртуальный диск (qcow2) | Overlay FS (CoW) | Overlay + volumes |
| **Эксплойт ядра** | Не затрагивает хост | Побег из контейнера | Побег из контейнера |

---

## Ментальные модели

### Правильные

```
VM        = виртуальная аппаратная платформа с собственным ядром
Контейнер = изолированный процесс (с ограниченной видимостью и ресурсами)
Pod       = группа процессов с общими ресурсами (аналог process group)
```

### Опасные (неправильные)

- **"Контейнер = лёгкая VM"** — нет. Общее ядро, видимость процессов на хосте, другая модель безопасности
- **"Pod = просто несколько контейнеров вместе"** — нет. Важны общие namespaces через pause
- **"VM = один процесс"** — только для KVM/QEMU. Для Type-1 (ESXi) — ломается

---

## См. также

- [[VirtualMachine]] — виртуальные машины (VT-x, EPT, VMCS)
- [[Container]] — контейнеры (namespaces, cgroups, overlay FS, security)
- [[Pod]] — Pod (pause container, lifecycle, composition patterns)
- [[Kubernetes]] — основные концепции
- [[Deployments]] — управление Pod'ами
- [[K3s]] — наш кластер
